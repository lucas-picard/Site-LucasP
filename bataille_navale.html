<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Bataille Navale</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #0e2c0e;
      color: white;
      margin: 0;
      padding: 0;
    }

    body, a {
  font-family: "Arial", sans-serif; /* remplacez par votre police */
}

    /* === HEADER === */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 30px;
      background: linear-gradient(to right, #000000, #434343);
      border-bottom: 2px solid #66bb6a;
    }
    header h1 {
      font-size: 2em;
      color: white;
      text-shadow: 0 0 10px #66bb6a;
      margin: 0;
    }
    nav ul {
      display: flex;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    nav li {
      margin-left: 20px;
    }
    nav a {
      color: white;
      font-family: Satisfy, cursive;
      text-decoration: none;
      font-weight: bold;
    }
    nav a:hover {
      text-decoration: underline;
      color: lightgray;
      text-shadow: whitesmoke 0 0 10px;
    }

    /* === FOOTER === */
    footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background-color: #222;
      color: white;
      text-align: center;
      padding: 1em;
      font-size: 0.9em;
      border-top: 2px solid #66bb6a;
    }

    /* === ZONES DU JEU === */
    h2 { margin-top: 20px; }
    .hidden { display: none; }
    .boards {
      display: flex;
      justify-content: center;
      gap: 40px;
      margin-top: 20px;
    }
    canvas {
      border: 2px solid white;
      background: #fefefe;
      cursor: pointer;
    }

    /* === BOUTONS === */
    #menu button, #difficultyMenu button, #controls button {
      padding: 10px 20px;
      margin: 10px;
      border: none;
      background: #66bb6a;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    #menu button:hover, #difficultyMenu button:hover, #controls button:hover {
      background: #4CAF50;
      box-shadow: 0 0 10px #000;
    }

    #controls {
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <!-- HEADER -->
  <header>
    <h1>Lucas Picard</h1>
    <nav>
      <ul>
        <li><a href="accueil.html">Accueil</a></li>
        <li><a href="about.html">À propos</a></li>
        <li><a href="projets.html">Projets</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- TITRE -->
  <h2>Bataille Navale</h2>

  <!-- MENU PRINCIPAL -->
  <div id="menu">
    <button onclick="showDifficulty()">Jouer</button>
    <button onclick="window.close()">Quitter</button>
  </div>

  <!-- CHOIX DE DIFFICULTÉ -->
  <div id="difficultyMenu" class="hidden">
    <p>Choisissez la difficulté :</p>
    <button onclick="startGame('easy')">IA Facile</button>
    <button onclick="startGame('hard')">IA Difficile</button>
    <button onclick="backToMenu()">Retour</button>
  </div>

  <!-- JEU -->
  <div id="game" class="hidden">
    <div class="boards">
      <div>
        <h3>Votre grille</h3>
        <canvas id="playerBoard" width="300" height="300"></canvas>
      </div>
      <div>
        <h3>Grille IA</h3>
        <canvas id="aiBoard" width="300" height="300"></canvas>
      </div>
    </div>
    <div id="controls">
      <select id="boatSelect"></select>
      <button onclick="switchDirection()">Orientation: <span id="dirLabel">Horizontal</span></button>
      <button id="startBattle" onclick="startBattle()" disabled>Commencer</button>
      <button onclick="restartGame()">Recommencer</button>
    </div>
    <div id="status"></div>
  </div>

  <!-- FOOTER -->
  <footer>
    <p>&copy; 2025 Lucas Picard. Tous droits réservés</p>
  </footer>

  <!-- SCRIPT DU JEU -->
  <script>
    const SIZE = 10;
    const CELL = 30;
    const BOATS_INFO = {
      "Porte-avion": 5,
      "Croiseur": 4,
      "Contre-torpilleur 1": 3,
      "Contre-torpilleur 2": 3,
      "Torpilleur": 2
    };

    class Cell {
      constructor() { this.hasBoat=false; this.hit=false; this.boatId=null; }
    }
    class Board {
      constructor() {
        this.grid = Array.from({length:SIZE}, ()=>Array.from({length:SIZE}, ()=>new Cell()));
        this.boats={};
      }
      placeBoat(x,y,size,dir,name){
        if(this.boats[name]) return false;
        let coords=[];
        if(dir==="Horizontal"){
          if(x+size>SIZE) return false;
          for(let i=0;i<size;i++){ if(this.grid[y][x+i].hasBoat) return false; coords.push([x+i,y]); }
        } else {
          if(y+size>SIZE) return false;
          for(let i=0;i<size;i++){ if(this.grid[y+i][x].hasBoat) return false; coords.push([x,y+i]); }
        }
        coords.forEach(([cx,cy])=>{ this.grid[cy][cx].hasBoat=true; this.grid[cy][cx].boatId=name; });
        this.boats[name]=coords;
        return true;
      }
      receiveAttack(x,y){
        const c=this.grid[y][x];
        if(c.hit) return [false,null];
        c.hit=true;
        return [c.hasBoat,c.boatId];
      }
      isBoatSunk(name){ return this.boats[name]?.every(([x,y])=>this.grid[y][x].hit); }
      allBoatsSunk(){ return Object.keys(this.boats).every(b=>this.isBoatSunk(b)); }
    }

    let playerBoard, aiBoard, difficulty, direction="Horizontal";
    let playerCanvas=document.getElementById("playerBoard");
    let aiCanvas=document.getElementById("aiBoard");
    let ctxP=playerCanvas.getContext("2d"), ctxA=aiCanvas.getContext("2d");
    const boatSelect=document.getElementById("boatSelect");
    const dirLabel=document.getElementById("dirLabel");
    const status=document.getElementById("status");
    const startBtn=document.getElementById("startBattle");

    function drawBoard(ctx, board, hideBoats=false){
      ctx.clearRect(0,0,300,300);
      for(let y=0;y<SIZE;y++){
        for(let x=0;x<SIZE;x++){
          let c=board.grid[y][x];
          let color="white";
          if(c.hasBoat && !hideBoats) color="blue";
          if(c.hit) color=c.hasBoat?"red":"gray";
          ctx.fillStyle=color;
          ctx.fillRect(x*CELL,y*CELL,CELL,CELL);
          ctx.strokeRect(x*CELL,y*CELL,CELL,CELL);
        }
      }
    }

    function showDifficulty(){ 
      document.getElementById("menu").classList.add("hidden"); 
      document.getElementById("difficultyMenu").classList.remove("hidden"); 
    }
    function backToMenu(){ 
      document.getElementById("difficultyMenu").classList.add("hidden"); 
      document.getElementById("menu").classList.remove("hidden"); 
    }

    function startGame(diff){
      difficulty=diff;
      document.getElementById("difficultyMenu").classList.add("hidden");
      document.getElementById("game").classList.remove("hidden");
      playerBoard=new Board();
      aiBoard=new Board();
      drawBoard(ctxP,playerBoard);
      drawBoard(ctxA,aiBoard,true);
      boatSelect.innerHTML="";
      Object.keys(BOATS_INFO).forEach(b=>{
        let opt=document.createElement("option"); 
        opt.value=b; opt.textContent=b; 
        boatSelect.appendChild(opt); 
      });
      playerCanvas.addEventListener("click",placePlayerBoat);
      aiCanvas.removeEventListener("click",playerTurn);
      status.textContent="Placez vos bateaux";
    }

    function switchDirection(){
      direction=direction==="Horizontal"?"Vertical":"Horizontal";
      dirLabel.textContent=direction;
    }

    function placePlayerBoat(e){
      let rect=playerCanvas.getBoundingClientRect();
      let x=Math.floor((e.clientX-rect.left)/CELL);
      let y=Math.floor((e.clientY-rect.top)/CELL);
      let name=boatSelect.value;
      let size=BOATS_INFO[name];
      if(playerBoard.placeBoat(x,y,size,direction,name)){
        drawBoard(ctxP,playerBoard);
        boatSelect.querySelector(`option[value='${name}']`).remove();
        if(boatSelect.options.length===0){
          startBtn.disabled=false;
          playerCanvas.removeEventListener("click",placePlayerBoat);
        }
      } else alert("Placement invalide !");
    }

    function startBattle(){
      for(let [name,size] of Object.entries(BOATS_INFO)){
        let placed=false;
        while(!placed){
          let x=Math.floor(Math.random()*SIZE), y=Math.floor(Math.random()*SIZE);
          let dir=Math.random()<0.5?"Horizontal":"Vertical";
          placed=aiBoard.placeBoat(x,y,size,dir,name);
        }
      }
      drawBoard(ctxA,aiBoard,true);
      drawBoard(ctxP,playerBoard);
      status.textContent="Votre tour";
      aiCanvas.addEventListener("click",playerTurn);
      startBtn.disabled=true;
    }

    function playerTurn(e){
      let rect=aiCanvas.getBoundingClientRect();
      let x=Math.floor((e.clientX-rect.left)/CELL);
      let y=Math.floor((e.clientY-rect.top)/CELL);
      let c=aiBoard.grid[y][x];
      if(c.hit) return;
      let [hit,boat]=aiBoard.receiveAttack(x,y);
      drawBoard(ctxA,aiBoard,true);
      if(hit && aiBoard.isBoatSunk(boat)) alert("Vous avez coulé le "+boat);
      if(aiBoard.allBoatsSunk()){ status.textContent="Victoire !"; aiCanvas.removeEventListener("click",playerTurn); return; }
      setTimeout(()=>aiTurn(),500);
    }

    function aiTurn(){
      let x,y;
      if(difficulty==="easy"){
        do{x=Math.floor(Math.random()*SIZE); y=Math.floor(Math.random()*SIZE);}while(playerBoard.grid[y][x].hit);
      } else {
        let choices=[];
        for(let yy=0;yy<SIZE;yy++){ 
          for(let xx=0;xx<SIZE;xx++){ 
            if((xx+yy)%2===0 && !playerBoard.grid[yy][xx].hit) choices.push([xx,yy]); 
          }
        }
        if(choices.length) [x,y]=choices[Math.floor(Math.random()*choices.length)];
        else do{x=Math.floor(Math.random()*SIZE); y=Math.floor(Math.random()*SIZE);}while(playerBoard.grid[y][x].hit);
      }
      let [hit,boat]=playerBoard.receiveAttack(x,y);
      drawBoard(ctxP,playerBoard);
      if(hit && playerBoard.isBoatSunk(boat)) alert("L'IA a coulé votre "+boat);
      if(playerBoard.allBoatsSunk()){ status.textContent="Défaite !"; aiCanvas.removeEventListener("click",playerTurn); }
    }

    function restartGame() {
      document.getElementById("game").classList.add("hidden");
      document.getElementById("difficultyMenu").classList.add("hidden");
      document.getElementById("menu").classList.remove("hidden");
      ctxP.clearRect(0,0,300,300);
      ctxA.clearRect(0,0,300,300);
      playerBoard = null;
      aiBoard = null;
      difficulty = null;
      direction = "Horizontal";
      dirLabel.textContent = direction;
      startBtn.disabled = true;
      status.textContent = "";
    }
  </script>
</body>
</html>


